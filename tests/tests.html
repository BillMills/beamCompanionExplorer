<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>helper.js testing</title>
        <link rel="stylesheet" href="../css/qunit.css">
    </head>
    <body>
        <div id="qunit"></div>
        <div id="qunit-fixture"></div>
        <script src="../scripts/qunit.js"></script>
        <script src='../scripts/datastore.js' type="text/javascript"></script>
        <script src="../scripts/helpers.js"></script>

        <script>
            QUnit.test( "species2z", function( assert ) {
                assert.equal(species2z('H'), 1, 'H has Z=1');
                assert.equal(species2z('Ca'), 20, 'Ca has Z=20');
                assert.equal(species2z('Po'), 84, 'Po has Z=84');
            });

            QUnit.test( "chemCase", function( assert ) {
                assert.equal(chemCase('xxx'), 'Xxx', 'xxx -> Xxx');
                assert.equal(chemCase('XXX'), 'Xxx', 'XXX -> Xxx');
                assert.equal(chemCase(''), '', 'empty string returns empty string');
            }); 

            QUnit.test( "arrangePoints", function( assert ) {
                assert.deepEqual(   arrangePoints( [0,1,2,3], [10,11,12,13], [1,2,1,2]), 
                                    [
                                         [0,10,null],
                                         [1,null,11],
                                         [2,12,null],
                                         [3,null,13] 
                                    ],
                                    'create array of arrays of pairwise elements' 
                                );
            }); 

            QUnit.test( "HTMLement", function( assert ) {
                assert.equal(HTMLement(50, 8, 'Ca'), '<strong><sup>50</sup>Ca<sup>8+</sup></strong>', 'wrap A, Q and species in html');
            });

            QUnit.test( "determineAQ", function( assert ) {
                dataStore.energyLoss = -10;
                assert.equal(determineAQ(50, 8), (50-8*dataStore.eMass)/8, 'correct behavior with negative energy loss');
                dataStore.energyLoss = 100;
                assert.equal(determineAQ(50, 8), 0, 'correct behavior with positive energy loss');
            });

            QUnit.test( "validChargeStates", function( assert ) {
                assert.deepEqual(validChargeStates(8,16), [{
                    'q': 3,
                    'AQ': ((16 - 3*dataStore.eMass)/3).toFixed(3)
                }]
                , '16-O has one valid charge state, the 3+');
            }); 

            QUnit.test( "findSurfaceIonIsobars", function( assert ) {
                assert.deepEqual(findSurfaceIonIsobars(4), [{
                    'A': 4,
                    'Z': 3
                }]
                , 'A=4 has one valid surface ionization isobar, 4-Li');
            });

            QUnit.test( "findDecayChain", function( assert ) {
                assert.deepEqual(findDecayChain(20, 54), 
                [
                    {
                        'A': 54,
                        'Z': 21
                    },
                    {
                        'A': 54,
                        'Z': 22
                    },
                    {
                        'A': 54,
                        'Z': 23
                    },
                    {
                        'A': 54,
                        'Z': 24
                    }
                ]
                , '54-Ca decays through Sc, Ti, V, Cr.');

                //right on drip line
                assert.deepEqual(findDecayChain(2, 10), 
                [
                    {
                        'A': 10,
                        'Z': 3
                    },
                    {
                        'A': 10,
                        'Z': 4
                    },
                    {
                        'A': 10,
                        'Z': 5
                    }
                ]
                , '10-He decays through Li, Be, B.');

                //past drip line
                assert.deepEqual(findDecayChain(2, 11), [], 'past drip line returns empty array');
            });            
        </script>
      </body>
</html>